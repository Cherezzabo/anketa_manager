{"version":3,"names":[],"mappings":"","sources":["app.js"],"sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nvar APP = {};\nvar resultName = \"\";\nvar resultHouse = \"\";\n\nvar obj = {\n    testArr: ''\n};\n\n//Инициализация приложения\nAPP.init = function () {\n    this.load();\n    this.listener();\n};\n\n/*-----------------------------------------------*/\n/* Загрузка слайдеров и прочей лабуды при  загрузке окна\r\n /*-----------------------------------------------*/\n\nAPP.load = function () {\n\n    //Получение массива имен\n    APP.getJsonDataName('');\n\n    //Получение массива домов\n    APP.getJsonDataHouse('');\n};\n\n/*-----------------------------------------------*/\n/* Парсеры и генераторы html-кода\r\n /*-----------------------------------------------*/\n\nAPP.getJsonDataName = function (input) {\n    //Получение массива имен по текущим данным из строки ФИО\n    var searchContext = input;\n    // resultName = \"\";\n    var expr = new RegExp(searchContext, \"i\");\n\n    $.post('/json.php', { NAME: \"Y\" }, function (data) {\n        resultName = $.parseJSON(data);\n        var str = '<ul>';\n        $.each(resultName, function (i, elem) {\n            if (elem.name.search(expr) != -1) {\n                str += '<li  data-content=\"' + resultName[i].name.toLowerCase() + '\" id=\"' + resultName[i].name.toLowerCase() + '\">' + resultName[i].name;\n            };\n        });\n        $('#user_names').html(str);\n    });\n};\n\nAPP.getJsonDataHouse = function (input) {\n    //Получение массива имен по текущим данным из строки Выбрать строение\n    var searchContext = input;\n    // resultHouse = \"\";\n    var expr = new RegExp(searchContext, \"i\");\n\n    $.post('/json.php', { HOUSE: \"Y\" }, function (data) {\n        //Полученный JSON массив преобразуем в объект\n        resultHouse = $.parseJSON(data);\n        //Массив для хранения названий домов\n        var houseNames = [];\n        //При каждом элементе в объекте resultHouse сделать\n        $.each(resultHouse, function (i) {\n            //Проверить есть ли у дома хотя бы 1-ый вопрос\n            //{[\"name\": \"Название дома\", \"questions\": \"{[\"1\": \"Вопрос\"]}\"],...}\n            if (resultHouse[i].questions[1]) {\n                //Если да, то добавить название дома в массив\n                houseNames.push(resultHouse[i].name);\n            };\n        });\n        //Переменная для хранения сгенерированной html-строки \n        var str = '<ul>';\n        //При каждом элементе в объекте resultHouse сделать:\n        $.each(houseNames, function (i) {\n            if (houseNames[i].search(expr) != -1) {\n                //Положить в строчку название дома из массива\n                str += '<li data-content=\"' + houseNames[i].toLowerCase() + '\" id=\"' + houseNames[i].toLowerCase() + '\">' + houseNames[i];\n            };\n        });\n        //Выводим список всех домов, содержащих хотя бы один вопрос\n        $('#building').html(str);\n    });\n};\n\nAPP.generateQuestionsBlock = function (val) {\n    $.each(resultHouse, function (i) {\n        if (resultHouse[i].name == val) {\n            var givenHouse = resultHouse[i];\n            var str_q = '<h2>Выбрать пожелания</h2>';\n            for (var i in givenHouse.questions) {\n                if (givenHouse.questions[i]) {\n                    str_q += '<p><span>' + givenHouse.questions[i] + '</span></p><p><input type=\"radio\" name=\"extra' + i + '\" value=\"yes\" id=\"extra' + i + '_yes\"><label for=\"extra' + i + '_yes\"><span></span>Да</label> <input type=\"radio\" name=\"extra' + i + '\" value=\"no\" id=\"extra' + i + '_no\"><label for=\"extra' + i + '_no\"><span></span>Нет</label></p>';\n                };\n            };\n            $('#questions_block').html(str_q);\n            $('.input-other').css(\"display\", \"block\");\n\n            //Отслеживание кол-ва чекнутых радио-баттонов,\n            //если ровно половина, то активируется кнопка\n            $(':radio').bind('click', function () {\n                var radioCount = $(':radio');\n                var checkedCount = $(':checked');\n                if (radioCount.length / checkedCount.length == 2) {\n                    $('button.button').removeAttr(\"disabled\");\n                };\n            });\n        };\n    });\n};\n\n/*-----------------------------------------------*/\n/* Прослушка\r\n /*-----------------------------------------------*/\nAPP.listener = function () {\n\n    // Прослушка ввода поля ФИО\n    $('#user_name_input').bind('input', function () {\n        $('#user_names').css('display', 'block');\n        var val = $('#user_name_input').val();\n        var opts = $('#user_names > ul > li');\n        APP.getJsonDataName(val);\n        for (var i = 0; i < opts.length; i++) {\n            if (opts[i].innerHTML == val) {\n                $('#user_name_input').val(val);\n                $('#user_names').css('display', 'none');\n            };\n        };\n    });\n\n    //Подстановка ФИО в поле ввода с помощью клавиатурных стрелок\n    var countForArrowsForName = -1;\n    $('#user_name_input').on('keydown', function (event) {\n        var key = event.keyCode;\n        var opts = $('#user_names > ul > li');\n        switch (key) {\n            case 38:\n                //up\n                countForArrowsForName--;\n                if (countForArrowsForName == -2) {\n                    countForArrowsForName = -1;\n                }\n                var givenOpt = opts[countForArrowsForName];\n                $(opts).css('background', '#fff');\n                $(givenOpt).css('background', '#eee');\n                break;\n            case 40:\n                //down\n                countForArrowsForName++;\n                var givenOpt = opts[countForArrowsForName];\n                $(opts).css('background', '#fff');\n                $(givenOpt).css('background', '#eee');\n                break;\n            case 13:\n                //enter\n                var givenOpt = opts[countForArrowsForName];\n                var val = $('#user_name_input').val(givenOpt.innerHTML);\n                $('#user_names').css('display', 'none');\n                APP.generateQuestionsBlock(val.val());\n                break;\n        };\n    });\n\n    //Подстановка строения в поле ввода кликом мыши\n    $('#user_names').on('click', function (event) {\n        var target = event.target;\n        var val = $('#user_name_input').val(target.innerHTML);\n        $('#user_names').css('display', 'none');\n    });\n\n    // Просушка ввода поля Выбрать строение\n    $('#house_input').bind('input', function () {\n        $('#building').css('display', 'block');\n        var val = $('#house_input').val();\n        var opts = $('#building > ul > li');\n        APP.getJsonDataHouse(val);\n\n        //Генерация блока вопросов, если название целиком введено с клавиатуры\n        for (var i = 0; i < opts.length; i++) {\n            if (opts[i].innerHTML == val) {\n                var val = $('#house_input').val(val);\n                $('#building').css('display', 'none');\n                APP.generateQuestionsBlock(val.val());\n            };\n        };\n    });\n\n    //Подстановка строения в поле ввода с помощью клавиатурных стрелок\n    var countForArrowsForHouses = -1;\n    $('#house_input').on('keydown', function (event) {\n        var key = event.keyCode;\n        var opts = $('#building > ul > li');\n        switch (key) {\n            case 38:\n                //up\n                countForArrowsForHouses--;\n                if (countForArrowsForHouses == -2) {\n                    countForArrowsForHouses = -1;\n                }\n                var givenOpt = opts[countForArrowsForHouses];\n                $(opts).css('background', '#fff');\n                $(givenOpt).css('background', '#eee');\n                break;\n            case 40:\n                //down\n                countForArrowsForHouses++;\n                var givenOpt = opts[countForArrowsForHouses];\n                $(opts).css('background', '#fff');\n                $(givenOpt).css('background', '#eee');\n                break;\n            case 13:\n                //enter\n                var givenOpt = opts[countForArrowsForHouses];\n                var val = $('#house_input').val(givenOpt.innerHTML);\n                $('#building').css('display', 'none');\n                APP.generateQuestionsBlock(val.val());\n                break;\n        };\n    });\n\n    //Подстановка строения в поле ввода кликом мыши\n    $('#building').on('click', function (event) {\n        var target = event.target;\n        var val = $('#house_input').val(target.innerHTML);\n        $('#building').css('display', 'none');\n        APP.generateQuestionsBlock(val.val());\n    });\n};\n\n\n\n},{}]},{},[1]);\n"],"file":"app.min.js","sourceRoot":"/source/"}